@startuml
box cirtificate microservice
participant Certificates as Cert
collections Storage
end box 

box "web microservice" #LightBlue
participant Web as Web
database    Database  as DB
end box 

Web -->  DB: get course
DB -->  Web: course data  
Web -->  DB: get finishers
DB -->  Web: course users

loop count(students)
   alt#Gold #LightBlue HTTP
      Web -> Cert: HTTP GET /certificate {course, student, templateName}
   else #Pink gRPC
      Web -> Cert: rpc certificate_issue {course, student, templateName}
   end
   group Certificate internal 
    alt#Gold #LightBlue select template
    Cert --> Cert: Запрос удовлетворен
else #Pink Error
    Cert --> Cert: Запрос отклонен
end
    alt#Gold #LightBlue print certificate
    Cert --> Cert: Запрос удовлетворен
else #Pink Error
    Cert --> Cert: Запрос отклонен
end
     alt#Gold #LightBlue generate name
    Cert --> Cert: Запрос удовлетворен
else #Pink Error
    Cert --> Cert: Запрос отклонен
end
     alt#Gold #LightBlue save file
    Cert --> Storage: Запрос удовлетворен
else #Pink Error
    Cert --> Storage: Запрос отклонен
end
   end
alt#Gold #LightBlue HTTP 200 OK certificate_url
    Cert --> Web: Запрос удовлетворен
else #Pink Error
    Cert --> Web: Запрос отклонен
end
  
end
@enduml